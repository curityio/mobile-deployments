<!--
  ~ Copyright (C) 2020 Curity AB. All rights reserved.
  ~
  ~ The contents of this file are the property of Curity AB.
  ~ You may not copy or use this file, in either source code
  ~ or executable form, except in compliance with terms
  ~ set by Curity AB.
  ~
  ~ For further information, please contact Curity AB.
  -->

<data xmlns="urn:ietf:params:xml:ns:yang:ietf-restconf">
    <profiles xmlns="https://curity.se/ns/conf/base">
        <profile>
            <id>token-service</id>
            <type xmlns:as="https://curity.se/ns/conf/profile/oauth">as:oauth-service</type>
            <expose-detailed-error-messages/>
            <settings>
                <authorization-server xmlns="https://curity.se/ns/conf/profile/oauth">
                    <client-store>
                        <config-backed>
                            <client>
                                <id>haapi-android-client</id>
                                <client-name>Haapi Android Client</client-name>
                                <secret>$5$2fpqE6shy2LpHKgg$UjLZrKEChl55JcRH6LzdoG1Fo.7DYxpaZVEoUezXWX8</secret>
                                <redirect-uris>app://haapi</redirect-uris>
                                <proof-key>
                                <require-proof-key>true</require-proof-key>
                                </proof-key>
                                <refresh-token-ttl>disabled</refresh-token-ttl>
                                <audience>haapi-client</audience>
                                <scope>openid</scope>
                                <scope>profile</scope>
                                <user-authentication>
                                </user-authentication>
                                <capabilities>
                                <code>
                                </code>
                                <haapi>
                                </haapi>
                                </capabilities>
                                <attestation>
                                <android>
                                    <package-name>io.curity.haapidemo</package-name>
                                    <signature-digest>Z2DKEZO2XWFWQnApoRCzhqhIxzODe7BUsArj4Up9oKQ=</signature-digest>
                                    <android-policy>android-prod-policy</android-policy>
                                </android>
                                </attestation>
                            </client>
                            <client>
                                <id>haapi-template-client</id>
                                <client-name>haapi-template-client</client-name>
                                <redirect-uris>app://haapi</redirect-uris>
                                <scope>openid</scope>
                                <scope>profile</scope>
                                <user-authentication>
                                </user-authentication>
                                <capabilities>
                                <code>
                                </code>
                                <haapi>
                                    <allow-without-attestation>true</allow-without-attestation>
                                </haapi>
                                </capabilities>
                                <dynamic-client-registration-template>
                                    <secret/>
                                    <authenticate-client-by>haapi-android-client</authenticate-client-by>
                                </dynamic-client-registration-template>
                                <use-pairwise-subject-identifiers>
                                    <sector-identifier>haapi-template-client</sector-identifier>
                                </use-pairwise-subject-identifiers>
                                <validate-port-on-loopback-interfaces>true</validate-port-on-loopback-interfaces>
                            </client>
                        </config-backed>
                    </client-store>
                    <dynamic-client-registration>
                        <client-data-source>default-datasource</client-data-source>
                        <templatized/>
                    </dynamic-client-registration>
                </authorization-server>
            </settings>
        </profile>
    </profiles>
    <facilities xmlns="https://curity.se/ns/conf/base">
        <client-attestation>
            <android-policy xmlns="https://curity.se/ns/conf/client-attestation">
                <id>android-prod-policy</id>
                <verify-boot-state>true</verify-boot-state>
                <minimum-security-level>trusted-env</minimum-security-level>
            </android-policy>
        </client-attestation>
    </facilities>
</data>
